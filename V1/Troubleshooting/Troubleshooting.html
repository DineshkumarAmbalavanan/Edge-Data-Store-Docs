<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Troubleshoot Edge Data Store </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Troubleshoot Edge Data Store ">
    <meta name="generator" content="docfx 2.43.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../V1/index.html" width="46">
                <img id="logo" src="../../V1/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="troubleShooting">
<h1 id="troubleshoot-edge-data-store">Troubleshoot Edge Data Store</h1>

<p>If you encounter errors while using or developing against Edge Data Store, you have both local and remote means of diagnosing issues.</p>
<p>Edge Data Store supports a diagnostics namespace that is used to store streams containing <a class="xref" href="../Diagnostics/Diagnostics.html">diagnostic</a> information from Edge Data Store itself. As with any other stream data stored in the Edge Storage component, you can egress this to either PI Web API or OSIsoft Cloud Services to monitor the state of a system remotely.</p>
<p>In addition, all components in Edge Data Store support OMF Health messages that can be configured using the <a href="xref:SystemHealthEndpointsConfiguration">Health Endpoint configuration</a> so that OMF Health messages are sent to remote PI Web API or OSIsoft Cloud Service endpoints to support remote monitoring of devices.</p>
<h2 id="omf-ingress">OMF ingress</h2>
<p>OMF ingress troubleshooting useful when a custom application is not writing stream data to EDS.</p>
<ul>
<li>Make sure the OMF messages are sent in the correct order (OMF type, OMF container, OMF data). 
  No data will be present until messages are received and processed in that order. Logging of warnings, errors, and message can help with resolving these issues.</li>
</ul>
<h3 id="omf-ingress-logging">OMF ingress logging</h3>
<p>You can find log messages related to egress in the Storage logs. </p>
<p>To output most information for troubleshooting, you should temporarily set the the log level to <strong>Trace</strong>.</p>
<h3 id="omf-ingress-message-debugging">OMF ingress message debugging</h3>
<p>In order to troubleshoot problems between an OMF application and Edge Storage, you should enable debugging. </p>
<ul>
<li><p>Set an appropriate value for the <em>IngressDebugExpiration</em> property in a storage runtime configuration. </p>
<p>  Debugging will be enabled for all incoming OMF messages, and HTTP request and response content will be stored to disk for review. The property represents the date and time when debugging should no longer be enabled. You can also disable debugging if you set the value to <em>null</em>.</p>
</li>
</ul>
<p>Examples of valid strings representing date and time:</p>
<pre><code>Utc: “yyyy-mm-ddThh:mm:ssZ”

Local: “mm-dd-yyyy hh:mm:ss”
</code></pre><p>The content of the OMF message, including the headers will be written to a file in the Logs directory. For an active application, this file can become quite large. As a result, debug information is stored to disk in a separate format than usual log messages. A single file is written to the usual Logs directory for every incoming OMF Type, Container, and data message.</p>
<h2 id="periodic-egress">Periodic egress</h2>
<p>EDS periodic egress extracts data from SDS streams and sends the appropriate sequences of type, container, and data OMF messages on startup.</p>
<ul>
<li>If you see unexpected data in an OCS or PI System, check if multiple devices are writing to the same stream. </li>
</ul>
<p>Careful use of stream prefixes in the <a class="xref" href="../Egress/Egress.html">periodic egress endpoint configuration</a> ensures that output data streams are logically separated in the systems of record.</p>
<p>Type prefixes may be helpful if you have a case where you have changed a stream type definitions on EDS. OMF types on both OCS and the PI System are immutable once created. If the type of the data stream changes, it is best to either delete the old type definition (if nothing is still using it) or add a type prefix to create a new unique type that will be used by new streams egressing from EDS to the systems of record.</p>
<h3 id="periodic-egress-logging">Periodic egress logging</h3>
<p>You can find log messages related to egress in the Storage logs. </p>
<p>To output most information for troubleshooting, you can temporarily set the the log level to <strong>Trace</strong>.</p>
<h3 id="periodic-egress-debugging">Periodic egress debugging</h3>
<p>In order to troubleshoot problems between Edge Data Store and the destination, you should enable debugging. </p>
<ul>
<li><p>Set an appropriate value for the <em>DebugExpiration</em> property in an egress configuration.</p>
<p>  Debugging for that destination will be enabled, and HTTP request and response content will be stored to disk for review. The property represents the date and time when debugging should no longer be enabled. You can also disable debugging if you set the value to <em>null</em>.</p>
</li>
</ul>
<p>Examples of valid strings representing date and time:</p>
<pre><code>Utc: “yyyy-mm-ddThh:mm:ssZ”

Local: “mm-dd-yyyy hh:mm:ss”
</code></pre><p>The content length of each request/response and the overall number of requests/responses, can be quite large. As a result, debug information is stored to disk in a separate location than the typical log messages. Debug folders/files will be created under the Edge Data Store data folder. The debug folder/file structure is:</p>
<pre><code>Windows: %programdata%\OSIsoft\EdgeDataStore\Storage\egressdump\{tenantId}\{namespaceId}\{egressId}\{omfType}\{Ticks}-{Guid}-{Req/Res}.txt

Linux: /usr/share/OSIsoft/EdgeDataStore/Storage/egressdump/{tenantId}/{namespaceId}/{egressId}/{omfType}/{Ticks}-{Guid}-{Req/Res}.txt
</code></pre><p><em>omfType</em> represents Type/Container/Data;
<em>Ticks</em> represents the tick count for the Utc DateTime when it was decided that the message would be written to disk;
<em>Guid</em> represents a unique Guid for each request/response pair;
<em>Req/Res</em> whether it was the HTTP request or response.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/Edge-Data-Store-Docs/blob/master/V1/Troubleshooting/Troubleshooting.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
            <span id='copyright-text'>© 2019 - OSIsoft, LLC.<span>
        </span></span></div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
